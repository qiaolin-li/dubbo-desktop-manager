# 一、简介

1、支持扩展数据源，数据源包括：获取服务、获取提供者、获取消费者、启用提供者、禁用提供者、调用提供者等
2、数据源插件可以设置自己支持哪些调用模式，例如Telnet、Java、还可以扩展自己的实现，默认参数生成器也是
3、数据源可以支持用户自定义设置参数，例如调用超时的参数等
3、调用方法支持扩展，扩展点为调用前、调用后、异常时等、方便做一些参数的预处理、结果的预处理
4、调用功能方事件发布，方便插件做一些处理，例如调用成功、调用失败等



# 二、数据源提供者
配置信息：
例如：

```js
{
    formConfig: {
        name: "新增Dubbo Nacos数据源",
        type: "my-nacos",
		invokerTypeList: ['java', 'telnet'], // 可用的执行器列表，如果不填则为全部
        properties: [{
            label: '地址',			// 显示名称，如果不存在，取name
            name: "address",		 // 配置key名称
            type: "input",			 // 交互类型：input、password、select、switch
            required: true, 
            placeholder: '',
            default: '',
            multiple: true, 		// 当type 等于select时生效
            choices: [{    			// 当 type等于select时生效
                name: '',
                value: '',
            }],
            validate: (value) => {} 
        },{
            name: "group",
            validate: (value) => {}
        }],
        test: (datasource) => true
    },
    realTimeSearch: false,      // 为false时，用户搜索服务只是前端过滤，为true会调用下面的 getServiceList 方法
    
}
```

 

```js
{
    // datasource: 数据源信息
    // keyword：用户输入的关键字，如果是数据源提供者配置 realTimeSearch = true，则false永远为空
    getServiceList: (datasource, keyword) =>{
        return {
            list: [{
                // 服务全类名
                serviceName: "indi.qiaolin.TestFacade" ,
                // 服务唯一标识, 如果不提供这个字段，将会使用 serviceName
                uniqueServiceName: "indi.qiaolin.TestFacade:1.0.0",
                // 服务类型
             	serviceType: "dubbo",   
            }],
      		separator: '.',   			// 如果将你的serviceName分割成树，
      		packageSeparator: '.'		// 分割出来的包合并时的分隔符
        }
    }
    
    // datasource 数据源信息
    // service 用户点击的服务信息
    // options: 选项信息，例如source === 'dubboProviderList'就不需要生成方法参数信息，加快速度
    // {
    //  	'source': 'dubboProviderList || dubboInvoke'
	// }
    getProviderList: (datasource, service, options) =>{
        return [{
            application: "dubbo-demo",
            ip: "192.168.0.243",
            port: "10086",
            address: "192.168.0.243:10086",         
            // 服务全类名
            serviceName: "indi.qiaolin.TestFacade" ,
            // 服务唯一标识, 如果不提供这个字段，将会使用 serviceName
            uniqueServiceName: "indi.qiaolin.TestFacade:1.0.0",
            group: "",			// 分组
            version: "1.0.0",	// 接口版本
            deprecated: false,  // 是否过时
            weight: 100,		// 提供者权重
            disabled: true,		// true 为禁用，false为启用
            
            "protocol": "dubbo",
            "dubboVersion": "2.7.4.1",
            "providerVersion": "",
  
            
            methods: [
                {
                    name: "test",
                    parameterTypes: [
                        "indi.qiaolin.Request"
                    ],
            		defaultParameter: "['']",
                    returnType: "indi.qiaolin.Result", 
                }
            ],
            properties: {   // 这里可以放置一些自己的信息
                generic: "false",
                dubboVersion: "2.7.4.1",
           		qosPort: "10087",
                revision: "24.05.29-RC",
               
            }
        }];
    }

    getConsumerList(datasource, service, options){
        return [{
            "application": "clark-test",
            "ip": "192.168.0.177",
            "disabled": false,  				 // 是否被禁用了
            "timeout": "300",					 // 超时时间
            "retries": "1",						 // 重试次数
            "providerVersion": "23.07.08-RELEASE",	 // 依赖的api版本
            "version": "1.0.0",					 // 依赖的服务版本
            dubboVersion: "2.7.4.1",			 // 当前dubbo版本
            
            // 这里可以放置需要现实的属性
            "properties" :{
             	"methods": [ "test"  ],
                check: false,
                dubbo: "2.0.2",
                lazy: false,
                pid: "56",
                sticky: false"  
            } 
        }];
    }

    disableProvider(datasource, service, provder, options){
        // 禁用它

    }

    enableProvider(datasource, service, provder, options){
        // 启用它
    }


    // invocation = {
    // 		methodInfo: 方法信息
    // 		params: 调用的参数
    // 		invokerType: telnet、java、或者为空，
	// }
    invokeMethod(datasource, service, provder, invocation){

    }

}

```

